<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>{{ page.title }} | {{ site.title }}</title>
<link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">
<link rel="icon" href="{{ '/assets/images/favicon.png' | relative_url }}">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<!-- Noise overlay -->
<div class="noise-overlay"></div>

<!-- Digital grid -->
<div class="digital-grid"></div>

<!-- Boot Sequence - ONLY ON HOMEPAGE -->
{% if page.url == "/" %}
<div id="boot-sequence" class="boot">
<pre id="boot-text"></pre>
</div>
{% endif %}

<!-- Main Content -->
<div id="main-content" {% if page.url != "/" %}style="display:block;"{% else %}style="display:none;"{% endif %}>
<header>
<h1 class="title">{{ site.title }}</h1>
<p class="desc">{{ site.description }}</p>
{% if page.url != "/" %}
<nav>
<a href="{{ '/' | relative_url }}" class="home-link">← Back to Lab</a>
</nav>
{% endif %}
</header>
<main>
{{ content }}
</main>
</div>

<!-- Glowing Cursor -->
<div class="cursor-light"></div>

<!-- Matrix Canvas Script -->
<script>
document.addEventListener("DOMContentLoaded", () => {
const canvas = document.createElement("canvas");
canvas.id = "matrix";
document.body.prepend(canvas);
const ctx = canvas.getContext("2d");
canvas.height = window.innerHeight;
canvas.width = window.innerWidth;
const chars = "0123456789ABCDEF⧫⌘∑∫λΩ⊕⊗⟡";
const drops = Array(Math.floor(canvas.width / 14)).fill(1);
function draw() {
ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
ctx.fillRect(0, 0, canvas.width, canvas.height);
ctx.fillStyle = "#39ff14";
ctx.font = "15px monospace";
for (let i = 0; i < drops.length; i++) {
const text = chars.charAt(Math.floor(Math.random() * chars.length));
ctx.fillText(text, i * 14, drops[i] * 18);
if (drops[i] * 18 > canvas.height && Math.random() > 0.975) drops[i] = 0;
drops[i]++;
}
}
setInterval(draw, 35);
window.addEventListener("resize", () => {
canvas.height = window.innerHeight;
canvas.width = window.innerWidth;
});
});
</script>

<!-- Boot & Cursor Script -->
<script>
{% if page.url == "/" %}
// Only run boot animation on homepage
document.addEventListener("DOMContentLoaded", () => {
  const bootLines = [">Great to see you. I'm 0xm0t0k0 aka 0xth00rf1nn aka c1nn4m0nr0ls"];
  const bootText = document.getElementById("boot-text");
  const bootScreen = document.getElementById("boot-sequence");
  const mainContent = document.getElementById("main-content");
  
  let line = 0, char = 0;
  
  function typeBootLine() {
    if (line < bootLines.length) {
      if (char < bootLines[line].length) {
        bootText.textContent += bootLines[line].charAt(char);
        char++;
        setTimeout(typeBootLine, 30);
      } else {
        bootText.textContent += "\n";
        line++;
        char = 0;
        setTimeout(typeBootLine, 400);
      }
    } else {
      setTimeout(() => {
        bootScreen.style.opacity = "0";
        setTimeout(() => {
          bootScreen.style.display = "none";
          mainContent.style.display = "block";
        }, 1000);
      }, 600);
    }
  }
  
  typeBootLine();
});
{% endif %}

// Cursor animation - runs on all pages
const cursor = document.querySelector(".cursor-light");
let x = 0, y = 0, targetX = 0, targetY = 0;

document.addEventListener("mousemove", e => {
  targetX = e.clientX;
  targetY = e.clientY;
});

function animateCursor() {
  x += (targetX - x) * 0.15;
  y += (targetY - y) * 0.15;
  if (cursor) {
    cursor.style.left = `${x}px`;
    cursor.style.top = `${y}px`;
  }
  requestAnimationFrame(animateCursor);
}
animateCursor();
</script>
</body>
</html>